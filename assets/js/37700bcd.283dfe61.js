"use strict";(self.webpackChunkhkb=self.webpackChunkhkb||[]).push([[36],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var r=a(7294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,s=function(e,t){if(null==e)return{};var a,r,s={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var l=r.createContext({}),c=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,s=e.mdxType,n=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=c(a),u=s,m=p["".concat(l,".").concat(u)]||p[u]||h[u]||n;return a?r.createElement(m,o(o({ref:t},d),{},{components:a})):r.createElement(m,o({ref:t},d))}));function m(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var n=a.length,o=new Array(n);o[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:s,o[1]=i;for(var c=2;c<n;c++)o[c]=a[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},8719:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>n,metadata:()=>i,toc:()=>c});var r=a(7462),s=(a(7294),a(3905));const n={},o="Active Directory Hacking",i={unversionedId:"commands-cheatsheet/active-directory-hacking",id:"commands-cheatsheet/active-directory-hacking",title:"Active Directory Hacking",description:"A lot of the commands in this cheatsheet are taken from a Hack the Box blog post.",source:"@site/docs/commands-cheatsheet/active-directory-hacking.md",sourceDirName:"commands-cheatsheet",slug:"/commands-cheatsheet/active-directory-hacking",permalink:"/hkb/commands-cheatsheet/active-directory-hacking",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Pass the Hash",permalink:"/hkb/commands-cheatsheet/windows/pass-the-hash"},next:{title:"CrackMapExec",permalink:"/hkb/commands-cheatsheet/crackmapexec"}},l={},c=[{value:"Powershell",id:"powershell",level:2},{value:"Load the built-in Active Directory PowerShell module",id:"load-the-built-in-active-directory-powershell-module",level:3},{value:"List domain users using Get-ADUser and filter by the username",id:"list-domain-users-using-get-aduser-and-filter-by-the-username",level:3},{value:"Check the description field of domain users for sensitive data such as passwords",id:"check-the-description-field-of-domain-users-for-sensitive-data-such-as-passwords",level:3},{value:"Responder",id:"responder",level:2},{value:"Analysis mode",id:"analysis-mode",level:3},{value:"Response spoofing to gather NTLMv2 password hashes",id:"response-spoofing-to-gather-ntlmv2-password-hashes",level:3},{value:"Kerbrute",id:"kerbrute",level:2},{value:"Enumerate valid Active Directory users for password spraying",id:"enumerate-valid-active-directory-users-for-password-spraying",level:3},{value:"Hashcat",id:"hashcat",level:2},{value:"Crack an NTLMv2 hash gathered with Responder",id:"crack-an-ntlmv2-hash-gathered-with-responder",level:3},{value:"CrackMapExec",id:"crackmapexec",level:2},{value:"Enumerate the domain password policy",id:"enumerate-the-domain-password-policy",level:3},{value:"SMB NULL sessions on a dc host and enumerate valid users",id:"smb-null-sessions-on-a-dc-host-and-enumerate-valid-users",level:3}],d={toc:c},p="wrapper";function h(e){let{components:t,...a}=e;return(0,s.kt)(p,(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"active-directory-hacking"},"Active Directory Hacking"),(0,s.kt)("admonition",{title:"Credits to Hack the Box",type:"info"},(0,s.kt)("p",{parentName:"admonition"},"A lot of the commands in this cheatsheet are taken from a ",(0,s.kt)("a",{parentName:"p",href:"https://www.hackthebox.com/blog/active-directory-penetration-testing-cheatsheet-and-guide"},"Hack the Box blog post"),".")),(0,s.kt)("h2",{id:"powershell"},"Powershell"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Also found in:")," ",(0,s.kt)("a",{parentName:"p",href:"/commands-cheatsheet/windows/batch-and-powershell"},"Batch and Powershell Cheatsheet")),(0,s.kt)("h3",{id:"load-the-built-in-active-directory-powershell-module"},"Load the built-in Active Directory PowerShell module"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="PowerShell"',title:'"PowerShell"'},"Import-Module ActiveDirectory\n")),(0,s.kt)("h3",{id:"list-domain-users-using-get-aduser-and-filter-by-the-username"},"List domain users using Get-ADUser and filter by the username"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="PowerShell"',title:'"PowerShell"'},"Get-ADUser -Filter * | select Name\n")),(0,s.kt)("h3",{id:"check-the-description-field-of-domain-users-for-sensitive-data-such-as-passwords"},"Check the description field of domain users for sensitive data such as passwords"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="PowerShell"',title:'"PowerShell"'},"Get-DomainUser * | Select-Object samaccountname,description\n")),(0,s.kt)("h2",{id:"responder"},"Responder"),(0,s.kt)("h3",{id:"analysis-mode"},"Analysis mode"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"sudo responder -I <interface> -A\n")),(0,s.kt)("h3",{id:"response-spoofing-to-gather-ntlmv2-password-hashes"},"Response spoofing to gather NTLMv2 password hashes"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"sudo responder -I <interface> -w -d\n")),(0,s.kt)("h2",{id:"kerbrute"},"Kerbrute"),(0,s.kt)("h3",{id:"enumerate-valid-active-directory-users-for-password-spraying"},"Enumerate valid Active Directory users for password spraying"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kerbrute userenum -d <domain> --dc <ip> jsmith.txt -o kerb-results\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kerbrute passwordspray -d <domain> --dc <ip> valid_users.txt <password>\n")),(0,s.kt)("h2",{id:"hashcat"},"Hashcat"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Also found in:")," ",(0,s.kt)("a",{parentName:"p",href:"/commands-cheatsheet/hashcat"},"Hashcat Cheatsheet")),(0,s.kt)("h3",{id:"crack-an-ntlmv2-hash-gathered-with-responder"},"Crack an NTLMv2 hash gathered with Responder"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"hashcat -m 5600 <hash> <wordlist>\n")),(0,s.kt)("h2",{id:"crackmapexec"},"CrackMapExec"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Also found in:")," ",(0,s.kt)("a",{parentName:"p",href:"/commands-cheatsheet/crackmapexec"},"SMB Cheatsheet")),(0,s.kt)("h3",{id:"enumerate-the-domain-password-policy"},"Enumerate the domain password policy"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"crackmapexec smb <ip> -u <user> -p <password> --pass-pol\n")),(0,s.kt)("h3",{id:"smb-null-sessions-on-a-dc-host-and-enumerate-valid-users"},"SMB NULL sessions on a dc host and enumerate valid users"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"crackmapexec smb <ip> -u '' -p '' --users --export $(pwd)/users.txt\n")))}h.isMDXComponent=!0}}]);